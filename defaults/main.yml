---
# title: role-samba4-primary-ad-dc
#
# Author: bitfinity-nl
# Version: 1.0
# File: defaults/main.yml
#
# Description: Creating a primary Active Directory Domain Controller.

# -- Samba4 AD settings --
#
# Variable(s):
#   ad_role           : 'additional'                          # Set samba4 role primary (only for initial setup), additional, member.
#   smb_workgroup      : 'LAB'                                 # Set workgroup (should be in capital letters).
#   smb_realm          : 'LAB.LOCAL'                           # Set realm (should be in capital letters).
#   smb_dns_servers    : '{{ ansible_facts['default_ipv4'].address }}'  # Set current ipv4 address.
#   smb_dns_forwarders : '8.8.8.8 8.8.4.4'                     # Set DNS forwarders.
#   smb_username       : 'Administrator'                       # Set administrator account.
#   smb_password       : 'Welcome01'                           # Set administrator password.
#   smb_site           : 'Amsterdam'                           # Sets the SiteName (prevents Default-Site-First-Site)
#   smb_rsyncd_pass    : 'Welcome01'                           # Sets the rsync daemon secret for sysvol sync
#
# Comment:
#   Override variable(s) by setting them in ./vars/main.yml
#
# yamllint disable rule:colons
# Please define your ad_role in the inventory
# valid choice is: primary. Any other value will be considered additional (as is the default)
# Will be used to set server role in smb.conf
ad_role: additional
force_sysvol_rsync: false

# The built-in DNS server of samba will be the only DNS server on this machine
# Set this to false if you know you will be running another DNS server (like pihole)
smb_is_only_dns: false
# If not the only DNS, on which port should samba listen
smb_dns_port: 5353
###
### These defaults are here for reference only, please override them in your vars/main.yml
### or in your local secrets vault file, as is included as first task in tasks/main.yml
smb_workgroup: WORKGROUP
smb_realm: WORKGROUP.LOCAL
smb_dns_servers: "{{ ansible_facts['default_ipv4'].address }}"
### These are the dns forwarders that will be used by samba to forward unresolvable queries
fallback_dns: ['8.8.8.8', '8.8.4.4']
smb_username: Administrator
smb_password: "{{ vault_smb_password }}"
smb_site: Sitename
# This will be used in case of multiple DC's to sync the sysvol and other stuff
smb_rsyncd_pass: "{{ vault_smb_password }}"


# These are the dns entries that will be used for forwarding unresolvable queries
# to the outside world. It is recommended to use your router or another local
# TODO: reflect the current changes in inventory. DNS servers are in group dns
smb_primary_dns: "{{ hostvars[groups['samba_ad_dc_primary'][0]]['ansible_host'] }}"
smb_secondary_dns: "{{ hostvars[groups['samba_ad_dc_additional'][0]]['ansible_host'] }}"
# Use the following line when you have no additional dc's defined
# smb_secondary_dns: 185.93.175.43
# yamllint enable rule:colons
